{% extends "base.html" %}

{% block content %}
<div class="container">
    <div style="display: flex; gap: 2rem; margin-bottom: 2rem;">
        <div style="flex: 1;">
            <img src="{{ book.cover_url }}" alt="{{ book.title }}" style="width: 100%; max-width: 400px; border-radius: 8px;">
        </div>
        
        <div style="flex: 2;">
            <h1>{{ book.title }}</h1>
            <p class="author" style="font-size: 1.2rem; color: #7f8c8d;">–ê–≤—Ç–æ—Ä: {{ book.author }}</p>
            <p class="price" style="font-size: 1.5rem; color: #e74c3c; font-weight: bold;">{{ book.price }} ‚ÇΩ</p>
            <p class="rating">‚≠ê –†–µ–π—Ç–∏–Ω–≥: {{ book.rating }}/5</p>
            <p class="year">üìÖ –ì–æ–¥ –∏–∑–¥–∞–Ω–∏—è: {{ book.year }}</p>
            <span class="genre" style="background: #ecf0f1; padding: 0.5rem 1rem; border-radius: 20px;">{{ book.genre }}</span>
            
            <div style="margin-top: 2rem;">
                {% if current_user.is_authenticated %}
                <a href="{{ url_for('main.add_to_cart', book_id=book.id) }}" class="btn btn-primary">üõí –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</a>
                {% else %}
                <p>–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <a href="{{ url_for('main.login') }}">–≤–æ–π—Ç–∏</a></p>
                {% endif %}
            </div>
        </div>
    </div>
    
    <div style="margin: 2rem 0;">
        <h2>üìñ –û–ø–∏—Å–∞–Ω–∏–µ</h2>
        <p>{{ book.description }}</p>
    </div>
    
    <div style="margin: 2rem 0;">
        <h2>üí¨ –û—Ç–∑—ã–≤—ã</h2>
        
        {% if current_user.is_authenticated %}
        <form method="POST" style="margin-bottom: 2rem;">
            {{ form.hidden_tag() }}
            
            <div class="form-group">
                {{ form.rating.label }}
                {{ form.rating(class="form-control") }}
            </div>
            
            <div class="form-group">
                {{ form.comment.label }}
                {{ form.comment(class="form-control", rows=4) }}
            </div>
            
            {{ form.submit(class="btn btn-primary") }}
        </form>
        {% else %}
        <p>–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—Ç–∑—ã–≤–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <a href="{{ url_for('main.login') }}">–≤–æ–π—Ç–∏</a></p>
        {% endif %}
        
        {% if reviews %}
        <div class="reviews">
            {% for review in reviews %}
            <div style="border: 1px solid #eee; padding: 1rem; margin-bottom: 1rem; border-radius: 8px;">
                <strong>‚≠ê {{ review.rating }}/5</strong>
                <p>{{ review.comment }}</p>
                <small>–û—Å—Ç–∞–≤–ª–µ–Ω {{ review.created_at.strftime('%d.%m.%Y %H:%M') }}</small>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p>–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>
        {% endif %}
    </div>
</div>
{% endblock %}